function Vector(t,r){this.x=t;this.y=r}Vector.prototype={rotate:function(t){var r=this.x;var n=this.y;this.x=Math.cos(t)*r-Math.sin(t)*n;this.y=Math.sin(t)*r+Math.cos(t)*n;return this},mult:function(t){this.x*=t;this.y*=t;return this},clone:function(){return new Vector(this.x,this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},subtract:function(t){this.x-=t.x;this.y-=t.y;return this},set:function(t,r){this.x=t;this.y=r;return this}};function Petal(t,r,n,o,e,a){this.stretchA=t;this.stretchB=r;this.startAngle=n;this.angle=o;this.bloom=a;this.growFactor=e;this.r=1;this.isfinished=false}Petal.prototype={draw:function(){var t=this.bloom.garden.ctx;var r,n,o,e;r=new Vector(0,this.r).rotate(Garden.degrad(this.startAngle));n=r.clone().rotate(Garden.degrad(this.angle));o=r.clone().mult(this.stretchA);e=n.clone().mult(this.stretchB);t.strokeStyle=this.bloom.c;t.beginPath();t.moveTo(r.x,r.y);t.bezierCurveTo(o.x,o.y,e.x,e.y,n.x,n.y);t.stroke()},render:function(){if(this.r<=this.bloom.r){this.r+=this.growFactor;this.draw()}else{this.isfinished=true}}};function Bloom(t,r,n,o,e){this.p=t;this.r=r;this.c=n;this.pc=o;this.petals=[];this.garden=e;this.init();this.garden.addBloom(this)}Bloom.prototype={draw:function(){var t,r=true;this.garden.ctx.save();this.garden.ctx.translate(this.p.x,this.p.y);for(var n=0;n<this.petals.length;n++){t=this.petals[n];t.render();r*=t.isfinished}this.garden.ctx.restore();if(r==true){this.garden.removeBloom(this)}},init:function(){var t=360/this.pc;var r=Garden.randomInt(0,90);for(var n=0;n<this.pc;n++){this.petals.push(new Petal(Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),r+n*t,t,Garden.random(Garden.options.growFactor.min,Garden.options.growFactor.max),this))}}};function Garden(t,r){this.blooms=[];this.element=r;this.ctx=t}Garden.prototype={render:function(){for(var t=0;t<this.blooms.length;t++){this.blooms[t].draw()}},addBloom:function(t){this.blooms.push(t)},removeBloom:function(t){var r;for(var n=0;n<this.blooms.length;n++){r=this.blooms[n];if(r===t){this.blooms.splice(n,1);return this}}},createRandomBloom:function(t,r){this.createBloom(t,r,Garden.randomInt(Garden.options.bloomRadius.min,Garden.options.bloomRadius.max),Garden.randomrgba(Garden.options.color.rmin,Garden.options.color.rmax,Garden.options.color.gmin,Garden.options.color.gmax,Garden.options.color.bmin,Garden.options.color.bmax,Garden.options.color.opacity),Garden.randomInt(Garden.options.petalCount.min,Garden.options.petalCount.max))},createBloom:function(t,r,n,o,e){new Bloom(new Vector(t,r),n,o,e,this)},clear:function(){this.blooms=[];this.ctx.clearRect(0,0,this.element.width,this.element.height)}};Garden.options={petalCount:{min:8,max:15},petalStretch:{min:.1,max:3},growFactor:{min:.1,max:1},bloomRadius:{min:8,max:10},density:10,growSpeed:1e3/60,color:{rmin:128,rmax:255,gmin:0,gmax:128,bmin:0,bmax:128,opacity:.1},tanAngle:60};Garden.random=function(t,r){return Math.random()*(r-t)+t};Garden.randomInt=function(t,r){return Math.floor(Math.random()*(r-t+1))+t};Garden.circle=2*Math.PI;Garden.degrad=function(t){return Garden.circle/360*t};Garden.raddeg=function(t){return t/Garden.circle*360};Garden.rgba=function(t,r,n,o){return"rgba("+t+","+r+","+n+","+o+")"};Garden.randomrgba=function(t,r,n,o,e,a,i){var s=Math.round(Garden.random(t,r));var h=Math.round(Garden.random(n,o));var d=Math.round(Garden.random(e,a));var c=5;if(Math.abs(s-h)<=c&&Math.abs(h-d)<=c&&Math.abs(d-s)<=c){return Garden.rgba(t,r,n,o,e,a,i)}else{return Garden.rgba(s,h,d,i)}};